; fname: ucs.p2dat
;
; Perform an unconfined compressive strength test on a bonded sample
;==============================================================================

program echo off

program call 'ss_wallf.fis'
program call 'fracturef.fis'

program echo on

; Model setup (optional, replace with "model restore 'your_model_name'" if you have an existing model)
; set up global parameters for stress and strain measurement
@setup_wall

; Create the fracture using the smooth joint model


; Assign contact and other properties to the fracture

; apply loading by moving top and bottom walls
wall attribute velocity-y -0.1 range id 1
wall attribute velocity-y 0.1 range id 2

; apply a small amount of damping
ball attribute damp 0.1

; record histories
fish history name 1 @axial_stress_wall
fish history name 2 @axial_strain_wall

; record cracks
@track_init
fish history name 3 @crack_num
; Create a fracture
; Create a fracture
fracture create position 0.0 0.0 dip 10.0 size 0.04
; Set the properties of the fracture to the smooth joint model
fracture pro 'cohesion' 12e6 'friction' 0.0 'kn' 4000e9 'ks' 500e9 
fracture contact-model model 'smoothjoint' install
; run some steps to get past initial vibrations

model cycle 1000

; run the test until stress falls below 70% of the peak
fish set peak_fraction = 0.7


; Set the contact material model

model solve fish-halt @loadhalt_wall
fish list @peak_stress

;==============================================================================
; eof: ucs.p2dat